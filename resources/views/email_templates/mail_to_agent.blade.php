<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PNR Created</title>
    <style>
        .passengerDetailshe {
            break-inside: avoid;text-align: center;color: rgb(35, 140, 195);
            font-size: 20px;padding: 20px 30px;border-left-width: 1px;border-left-color: rgb(192, 192, 192);
            border-right-width: 1px;border-right-style: solid;
            border-right-color: rgb(192, 192, 192);vertical-align: top;
        }
        .passengerdetails{
            break-inside: avoid;
            text-align: center; color: rgb(108, 108, 108); font-size: 16px; padding: 10px 30px 5px; font-weight: bold;
            border-left-width: 1px; border-left-color: rgb(192, 192, 192);
            border-right-width: 1px;
            border-right-style: solid;
            border-right-color: rgb(192, 192, 192);
            border-bottom-width: 1px;
            border-bottom-style: solid;
            border-bottom-color: rgb(192, 192, 192);
            vertical-align: top;
        }
    </style>

</head>
<body>

<table style="width: 1177px;
                        box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;
                        caret-color: rgb(0, 0, 0);
                        font-family: Helvetica;
                        font-size: 12px;
                        font-style: normal;
                        font-variant-caps: normal;
                        font-weight: normal;
                        letter-spacing: normal;
                        text-align: start;
                        text-indent: 0px;
                        text-transform: none;
                        white-space: normal;
                        word-spacing: 0px;
                        -webkit-text-stroke-width: 0px;
                        text-decoration: none;
                        background-color: #ffb200;">
    <tbody>
    <tr style="break-inside: avoid;">
        <td style="break-inside: avoid;
                            text-align: center;
                            color: rgb(255, 255, 255);
                            font-size: 16px;
                            padding: 30px;
                            line-height: 27px;
                        ">
            <b>Dear Our agent</b>
            <br>
            <b>There is a new booking that is done on our website
                <span class="Apple-converted-space">&nbsp;</span>
                <a href="{{ $appUrl ?? '#' }}" target="_blank" rel="noreferrer">{{ $appName }}</a>
                <span class="Apple-converted-space">&nbsp;</span>
            </b>
            <br>
            <span>
                Please confirm this reservation and issue the ticket
             </span>
        </td>
    </tr>
    </tbody>
</table>

<br style="caret-color: rgb(0, 0, 0);
                    font-family: Helvetica;
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;">

<table style="width: 1177px;
                    -webkit-box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;
                    box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;
                    caret-color: rgb(0, 0, 0);
                    font-family: Helvetica;
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    text-decoration: none;
                    background-color: rgb(245, 245, 245);">
    <tbody>
    <tr style="break-inside: avoid">
        <td style="break-inside: avoid;
                           width: 506.9375px;
                           text-align: left;
                           color: rgb(108, 108, 108);
                           font-size: 20px;
                           padding: 10px;
                           line-height: 27px;">
            <b>BOOKING REFERENCE NUMBER: &nbsp;</b>
        </td><td style="break-inside: avoid;
                             text-align: left;
                             color: rgb(108, 108, 108);
                             font-size: 20px;
                             padding: 10px;
                             line-height: 27px;"><span style="text-transform: capitalize; color: rgb(255, 0, 0)">{{ $data['PNR'] }}</span>
        </td>
    </tr>
    </tbody>
</table>
<br style="caret-color: rgb(0, 0, 0);
                    font-family: Helvetica;
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;">

<br style="caret-color: rgb(0, 0, 0);
        font-family: Helvetica;
        font-size: 12px;
        font-style: normal;
        font-variant-caps: normal;
        font-weight: normal;
        letter-spacing: normal;
        text-align: start;
        text-indent: 0px;
        text-transform: none;
        white-space: normal;
        word-spacing: 0px;
        -webkit-text-stroke-width: 0px;
        background-color: rgb(255, 255, 255);
        text-decoration: none;">

<div style="caret-color: rgb(0, 0, 0);
                    font-family: Helvetica;
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;
                    margin-top: 5px;">

    <table style="width: 1177px;box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;">
        <tbody>
        <tr style="break-inside: avoid">
            <th colspan="3" style="break-inside: avoid; text-align: left; padding: 12px; font-size: 20px; background-color: #ffb200; color: rgb(255, 255, 255); font-family: &quot;Trebuchet MS&quot;">
                Contact Person
            </th>
        </tr>
        <tr style="break-inside: avoid">
            <th class="passengerDetailsheads">Name</th>
            <th class="passengerDetailsheads">Email</th>
            <th class="passengerDetailsheads">Phone</th>
        </tr>

        <tr style="break-inside: avoid">
            <td class="passengerdetails">{{ auth()->guard('api')->check()?auth()->guard('api')->user()->name : $request['contact_person_name'] }}</td>
            <td class="passengerdetails">{{ auth()->guard('api')->check()?auth()->guard('api')->user()->email : $request['contact_email'] }}</td>
            <td class="passengerdetails">{{ auth()->guard('api')->check() ? auth()->guard('api')->user()->phone : $request['contact_phone'] }}</td>
        </tr>
        </tbody>
    </table>
</div>

<div style="caret-color: rgb(0, 0, 0);
                    font-family: Helvetica;
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;
                    margin-top: 5px;">

    <table style="width: 1177px;box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;">
        <tbody>
        <tr style="break-inside: avoid">
            <th colspan="4" style="break-inside: avoid; text-align: left; padding: 12px; font-size: 20px; background-color: #ffb200; color: rgb(255, 255, 255); font-family: &quot;Trebuchet MS&quot;">
                Passenger Details
            </th>
        </tr>
        <tr style="break-inside: avoid">
            <th class="passengerDetailsheads">Passenger Name</th>
            <th class="passengerDetailsheads">Passport Number</th>
            <th class="passengerDetailsheads">Expiration Date</th>
            <th class="passengerDetailsheads">Country</th>
        </tr>
        @foreach($request['passengerDetails'] as $passengerDetail)
            <tr style="break-inside: avoid">
                <td class="passengerdetails">{{ $passengerDetail['passengerTitle'] }} {{ $passengerDetail['passengerFirstName'] }} {{ $passengerDetail['passengerLastName'] }}</td>
                <td class="passengerdetails">{{ isset($passengerDetail['passport_number'])?$passengerDetail['passport_number']:null }}</td>
                <td class="passengerdetails">{{ isset($passengerDetail['passport_expire_date'])? \Carbon\Carbon::parse($passengerDetail['passport_expire_date'])->toFormattedDateString() :null }}</td>
                <td class="passengerdetails">{{ isset($passengerDetail['passport_issue_country'])?$passengerDetail['passport_issue_country']:null }}</td>
            </tr>
        @endforeach
        </tbody>
    </table>
</div>
<br style="caret-color: rgb(0, 0, 0);
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;">

<div style="caret-color: rgb(0, 0, 0);
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;
                    margin-top: 5px;">

    <table style="width: 1177px;box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;">
        <tbody>
        <tr style="break-inside: avoid">
            <th colspan="5" style="break-inside: avoid; text-align: left; padding: 12px; font-size: 20px; background-color: #ffb200; color: rgb(255, 255, 255); font-family: &quot;Trebuchet MS&quot;">
                Flight Details
            </th>
        </tr>
        <tr style="break-inside: avoid">
            <th class="passengerDetailsheads">Airline</th>
            <th class="passengerDetailsheads">Flight Number</th>
            <th class="passengerDetailsheads">Departure</th>
            <th class="passengerDetailsheads">Arrival</th>
            <th class="passengerDetailsheads">Flight Duration</th>
        </tr>

        @foreach($data['flight_segments'] as $segment)
            <tr style="break-inside: avoid">
                <td class="passengerdetails">{{ $segment['airline'] }}</td>
                <td class="passengerdetails">{{ $segment['flight_number'] }}</td>
                <td class="passengerdetails">{{ \Carbon\Carbon::parse($segment['departureDate'])->toFormattedDateString() }}<br>
                    {{ $segment['departureTime'] }}<br>
                    {{ $segment['originLocation']->toArray(response())['Name'] }},
                    {{ $segment['originLocation']->toArray(response())['Country'] }},
                    {{ $segment['originLocation']->toArray(response())['Code'] }}
                </td>
                <td class="passengerdetails">{{ \Carbon\Carbon::parse($segment['arrivalDate'])->toFormattedDateString() }}<br>
                    {{ $segment['arrivalTime'] }}<br>
                    {{ $segment['destinationLocation']->toArray(response())['Name'] }},
                    {{ $segment['destinationLocation']->toArray(response())['Country'] }},
                    {{ $segment['destinationLocation']->toArray(response())['Code'] }}
                </td>
                <td class="passengerdetails">{{ $segment['flight_duration'] }}</td>
            </tr>
        @endforeach

        </tbody>
    </table>
</div>
<br style="caret-color: rgb(0, 0, 0);font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration: none">

<!-- Flight Policies -->
<div style="caret-color: rgb(0, 0, 0);
                    font-size: 12px;
                    font-style: normal;
                    font-variant-caps: normal;
                    font-weight: normal;
                    letter-spacing: normal;
                    text-align: start;
                    text-indent: 0px;
                    text-transform: none;
                    white-space: normal;
                    word-spacing: 0px;
                    -webkit-text-stroke-width: 0px;
                    background-color: rgb(255, 255, 255);
                    text-decoration: none;
                    margin-top: 5px;">
    <table style="width: 1177px;box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px;">
        <tbody>
        <tr style="break-inside: avoid">
            <th colspan="5" style="break-inside: avoid; text-align: left; padding: 12px; font-size: 20px; background-color: #ffb200; color: rgb(255, 255, 255); font-family: &quot;Trebuchet MS&quot;">
                Flight Policies
            </th>
        </tr>
        <tr style="break-inside: avoid">
            <th class="passengerDetailsheads">Airline</th>
            <th class="passengerDetailsheads">baggage rules</th>
        </tr>

        @foreach($flight['flightSegments'] as $segment)
            @foreach($segment->baggage_rules as $baggage_rule)
            <tr style="break-inside: avoid">
                <td class="passengerdetails">{{ $baggage_rule->airlineName }}</td>
                <td class="passengerdetails"><a href="{{ $baggage_rule->baggage_url }}" target="_blank">{{ $baggage_rule->baggage_url }}</a></td>
            </tr>
            @endforeach
        @endforeach

        @if(! is_null($appTermsUrl))
            <table style="width: 1177px; -webkit-box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px; box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px">
                <tr style="break-inside: avoid">
                    <td style="break-inside: avoid; text-align: center; font-family: &quot;Trebuchet MS&quot;; color: #ffb200; font-size: 16px; padding: 10px 30px 5px; font-weight: bold; border-right-width: 1px; border-right-style: solid; border-right-color: rgb(192, 192, 192); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(192, 192, 192); vertical-align: top">

                        <a href="{{ $appTermsUrl }}" target="_blank">Terms and Conditions</a>
                    </td>
                </tr>
            </table>
        @endif

        </tbody>
    </table>
</div>

<table style="width: 1177px; -webkit-box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px; box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px">
    <tbody>
    <tr style="break-inside: avoid">
        <th colspan="5" style="break-inside: avoid; text-align: left; padding: 12px; font-size: 20px; background-color: #ffb200; color: rgb(255, 255, 255); font-family: &quot;Trebuchet MS&quot;">
            Total Price Details
        </th>
    </tr>
    <tr style="break-inside: avoid">
        <th class="passengerDetailsheads">Total Price</th>
        <th class="passengerDetailsheads">Discount Amount</th>
        <th class="passengerDetailsheads">New Price after discount</th>
    </tr>
    <tr style="break-inside: avoid">
        @if(array_key_exists('redeemedFare',$flight['pricingInfo']))
            <td class="passengerdetails">
                 0 ( Customer Spent {{ number_format($redeemPoints,2) }} points )
            </td>
        @else
            <td class="passengerdetails">
                {{ $flight['pricingInfo']['TotalFare_CurrencyCode'] }} {{ number_format($flight['pricingInfo']['TotalFare'],2) }}
            </td>
            <td class="passengerdetails">
                {{ $flight['pricingInfo']['TotalFare_CurrencyCode'] }} {{ $flight['pricingInfo']['discount_amount'] }}
            </td>
            <td class="passengerdetails">
                @php
                    $newFare = number_format($flight['pricingInfo']['newFare'],2);
                    $total = $newFare > 0 ? $newFare : number_format($flight['pricingInfo']['TotalFare'],2);
                @endphp
                {{ $flight['pricingInfo']['TotalFare_CurrencyCode'] }} {{ $total }}
            </td>
        @endif
    </tr>
    </tbody>
</table>

<br style="caret-color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration: none">
<br style="caret-color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration: none">

<table style="width: 1177px; -webkit-box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px; box-shadow: rgba(0, 0, 0, 0.431373) 2px 3px 3px 1px; caret-color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration: none; background-color: rgb(245, 245, 245)">
    <tbody>
    <tr style="break-inside: avoid">
        <td style="break-inside: avoid; width: 1153px; text-align: left; font-family: &quot;Trebuchet MS&quot;; color: rgb(108, 108, 108); font-size: 16px; padding: 10px; line-height: 27px">
            <b>Regards,</b>
            <br>
            <b>{{ $appName }} admin&nbsp;</b>
        </td>
    </tr>
    </tbody>
</table>

</body>
</html>
